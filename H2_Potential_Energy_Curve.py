import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
from scipy.signal import savgol_filter

# Data collected from fixed-nuclei calculations of H2, each calculation was
# run 3 times and averaged
# Data is indexed by 'bond length', 'energy', 'standard error'
Data = np.array([[0.6, -0.7732, 0.0027], \
                 [0.7, -0.9211, 0.0027], \
                 [0.8, -1.0200, 0.0011], \
                 [0.9, -1.0838, 0.0017], \
                 [1,   -1.1237, 0.0007], \
                 [1.1, -1.1494, 0.0012], \
                 [1.2, -1.1649, 0.0025], \
                 [1.3, -1.1724, 0.0018], \
                 [1.4, -1.1743, 0.0009], \
                 [1.5, -1.1732, 0.0014], \
                 [1.6, -1.1694, 0.0013], \
                 [1.7, -1.1610, 0.0016], \
                 [1.8, -1.1541, 0.0005], \
                 [1.9, -1.1450, 0.0005], \
                 [2,   -1.1400, 0.0008], \
                 [2.25,-1.1150, 0.0010], \
                 [2.5, -1.09369, 0.00013], \
                 [2.75,-1.0747, 0.0007], \
                 [3,   -1.0570, 0.0004], \
                 [3.5, -1.0310, 0.0014], \
                 [4,   -1.01662, 0.00023], \
                 [4.5, -1.0078, 0.0007], \
                 [5,   -1.0034, 0.0012], \
                 [6,   -1.0002, 0.0008], \
                 [7,   -1.0001, 0.0008], \
                 [8,   -0.9997, 0.0004]])

# Literature values from Pachucki (2010)
# Data is indexed by 'bond length', 'energy'
Lit_Data = np.array([[0.6, -0.769635], \
                        [0.7, -0.922027], \
                        [0.8, -1.020057], \
                        [0.9, -1.083643], \
                        [1.0, -1.124540], \
                        [1.1, -1.150057], \
                        [1.2, -1.164935], \
                        [1.25, -1.169420], \
                        [1.3, -1.172347], \
                        [1.32, -1.173139], \
                        [1.34, -1.17375], \
                        [1.36, -1.174148], \
                        [1.38, -1.174392], \
                        [1.39, -1.174453], \
                        [1.4, -1.174476], \
                        [1.41, -1.174461], \
                        [1.42, -1.174411], \
                        [1.44, -1.174208], \
                        [1.46, -1.173875], \
                        [1.48, -1.173421], \
                        [1.5, -1.172855], \
                        [1.55, -1.170995], \
                        [1.6, -1.168583], \
                        [1.7, -1.162459], \
                        [1.8, -1.155069], \
                        [1.9, -1.146851], \
                        [2, -1.138133], \
                        [2.1, -1.129164], \
                        [2.2, -1.120132], \
                        [2.3, -1.111182], \
                        [2.4, -1.102423], \
                        [2.5, -1.093938], \
                        [2.6, -1.085791], \
                        [2.7, -1.078028], \
                        [2.8, -1.070683], \
                        [2.9, -1.063778], \
                        [3, -1.057326], \
                        [3.1, -1.051334], \
                        [3.2, -1.045800], \
                        [3.3, -1.040717], \
                        [3.4, -1.036075], \
                        [3.5, -1.031858], \
                        [3.6, -1.028046], \
                        [3.7, -1.024618], \
                        [3.8, -1.021550], \
                        [3.9, -1.018816], \
                        [4, -1.016390], \
                        [4.2, -1.012360], \
                        [4.4, -1.009257], \
                        [4.6, -1.006895], \
                        [4.8, -1.005116], \
                        [5, -1.003786], \
                        [5.2, -1.002797], \
                        [5.4, -1.002065], \
                        [5.6, -1.001525], \
                        [5.8, -1.001128], \
                        [6, -1.000836], \
                        [6.5, -1.000401], \
                        [7, -1.000198], \
                        [7.5, -1.000102], \
                        [8, -1.000056]])

# Plotting the results
plt.errorbar(Data[:,0 ], Data[:,1], yerr=Data[:,2], capsize=4, fmt='x--', label='Data', color='tab:blue')
plt.plot(Lit_Data[:,0], Lit_Data[:,1], label='Literature', color='tab:red')
plt.xlabel(r'Bond Length / $a_0$')
plt.ylabel(r'Energy / Hartree')
plt.title(r'Energy of $H_2$ with Bond Length')
plt.legend()
plt.grid(True)
#plt.savefig("H2_PE_well.svg")
plt.show()
